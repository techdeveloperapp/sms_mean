{"version":3,"sources":["AdminComponents/streem/VideoStreem.js"],"names":["socket","io","VideoStreem","users","setusers","useState","loadingData","setloadingData","stream","setStream","remoteStream","setRemoteStream","localVideoRef","useRef","remoteVideoRef","peerRef","restrictions","setrestrictions","Students","name","value","Academics","HR","Library","Finance","VideoStream","createPeer","isInitiator","current","SimplePeer","initiator","trickle","on","data","emit","to","signal","srcObject","useEffect","async","localStream","navigator","mediaDevices","getUserMedia","video","audio","id","_jsx","children","_jsxs","ref","autoPlay","muted","style","width","marginRight","onClick","screenTrack","getDisplayMedia","getVideoTracks","replaceTrack","onended"],"mappings":"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","file":"static/js/157.87d1ec09.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport axios from \"../../store/axios\";\nimport io from 'socket.io-client';\nimport SimplePeer from 'simple-peer';\n\nconst socket = io();\n\nfunction VideoStreem() {\n  const [users, setusers] = useState([]);\n  const [loadingData, setloadingData] = useState(false);\n\n  const [stream, setStream] = useState(null);\n  const [remoteStream, setRemoteStream] = useState(null);\n  const localVideoRef = useRef();\n  const remoteVideoRef = useRef();\n  const peerRef = useRef();\n\n\n\n  const [restrictions, setrestrictions] = useState({\n    Students: [\n      { name: \"New Registration\", value: false },\n      { name: \"View Student Details\", value: false },\n      { name: \"Edit Student\", value: false },\n      { name: \"Student List\", value: false },\n      { name: \"Manage Scholarships\", value: false },\n      { name: \"Record Attendance\", value: false },\n      { name: \"Manage Section\", value: false },\n      { name: \"Manage Campuses\", value: false },\n      { name: \"Manage Dormitories\", value: false },\n      { name: \"Promotions/Demotions\", value: false },\n      { name: \"Prefects\", value: false },\n      { name: \"View Past Students\", value: false },\n      { name: \"View Withdrawn Students\", value: false },\n      { name: \"Delete Student\", value: false },\n      { name: \"Withdraw Student\", value: false },\n      { name: \"Re-enroll withdrawn Student\", value: false },\n    ],\n    Academics: [\n      { name: \"Manage Divisions\", value: false },\n      { name: \"Manage Classes\", value: false },\n      { name: \"Manage Subjects\", value: false },\n      { name: \"Manage Calendar\", value: false },\n      { name: \"Notes\", value: false },\n      { name: \"SBA\", value: false },\n      { name: \"Year Groups\", value: false },\n      { name: \"Terminal Reports\", value: false },\n      { name: \"Manage Letters / Correspondences\", value: false },\n    ],\n    HR: [\n      { name: \"Manage Departments\", value: false },\n      { name: \"Add Staff\", value: false },\n      { name: \"View Staff List/Details\", value: false },\n      { name: \"Edit Staff Details\", value: false },\n      { name: \"Staff Payroll\", value: false },\n      { name: \"PAYE Deductions\", value: false },\n      { name: \"Trustee\", value: false },\n      { name: \"SSNIT Contributions\", value: false },\n      { name: \"Staff Bank Details\", value: false },\n      { name: \"PAYE Calculator\", value: false },\n      { name: \"Delete/Archive Staff\", value: false },\n    ],\n    Library: [\n      { name: \"Books categories\", value: false },\n      { name: \"Books\", value: false },\n    ],\n    Finance: [\n      { name: \"View Set fees\", value: false },\n      { name: \"Set/Delete Fees\", value: false },\n      { name: \"Prepare Bill\", value: false },\n      { name: \"Bill Payment\", value: false },\n      { name: \"Initiate e-Payment Request\", value: false },\n      { name: \"Non-billable items payment\", value: false },\n      { name: \"View Payments\", value: false },\n      { name: \"Debtors Inventory module (View only)\", value: false },\n    ],\n    VideoStream: [\n        { name: \"View Set fees\", value: false },\n      ],\n  });\n\n  useEffect(() => {\n    setloadingData(true);\n    async function getUserMedia() {\n        const localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n        setStream(localStream);\n        localVideoRef.current.srcObject = localStream;\n      }\n      getUserMedia();\n  \n      socket.on('joined', id => {\n        if (socket.id === id) {\n          createPeer(true);\n        } else {\n          createPeer(false);\n        }\n      });\n  \n      socket.on('signal', data => {\n        peerRef.current.signal(data.signal);\n      });\n  \n      socket.emit('join', 'room1');\n  }, []);\n\n  function createPeer(isInitiator) {\n    peerRef.current = new SimplePeer({ initiator: isInitiator, stream, trickle: false });\n\n    peerRef.current.on('signal', data => {\n      socket.emit('signal', { to: 'room1', signal: data });\n    });\n\n    peerRef.current.on('stream', remoteStream => {\n      setRemoteStream(remoteStream);\n      remoteVideoRef.current.srcObject = remoteStream;\n    });\n  }\n\n  async function startScreenShare() {\n    const screenStream = await navigator.mediaDevices.getDisplayMedia({ video: true });\n    const screenTrack = screenStream.getVideoTracks()[0];\n    peerRef.current.replaceTrack(stream.getVideoTracks()[0], screenTrack, stream);\n    screenTrack.onended = () => {\n      peerRef.current.replaceTrack(screenTrack, stream.getVideoTracks()[0], stream);\n    };\n  }\n\n//   const handleCheckRole = (e, name) => {\n//     console.log(e, name);\n\n//     setrestrictions(\n//       Object.entries(restrictions).map((val, arr) =>\n//         val === e\n//           ? (restrictions[val] = arr.map((obj) =>\n//               obj.name === name ? { name, value: !obj.value } : obj\n//             ))\n//           : (restrictions[val] = arr)\n//       )\n//     );\n//   };\n\n  return (\n    <div>\n      {/* <div className=\" mb-5\">\n        {loadingData ? (\n          <>\n            <div className=\"d-flex justify-content-center content__container\">\n              <div className=\"spinner-border\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n              </div>\n            </div>\n          </>\n        ) : (\n            <h1>LLLLL</h1>\n        )}\n      </div> */}\n\n      \n<div>\n      <video ref={localVideoRef} autoPlay muted style={{ width: '300px', marginRight: '20px' }} />\n      <video ref={remoteVideoRef} autoPlay style={{ width: '300px' }} />\n      <button onClick={startScreenShare}>Share Screen</button>\n    </div>\n      \n    </div>\n  );\n}\n\nexport default VideoStreem;\n"],"sourceRoot":""}
(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[9],{1480:function(e,l,t){"use strict";t.r(l);var n=t(0),a=t(623),c=t.n(a),i=t(1338),s=t(1022),d=t.n(s),r=t(27),o=t(925),j=t(711),p=t(810),b=t(791),h=t(783),v=t(638),u=t(636),m=t.n(u),O=t(1285),x=t(97),f=t(10);function g(e){let{open:l,setOpen:t,descriptions:n,setdescriptions:a,prices:c,setprices:s,name:d,setname:r,title:u,settitle:g,isAdd:y,isPlans:N,onSubmit:C,loading:S}=e;const{register:P,handleSubmit:q,errors:T}=Object(v.a)(),k=()=>{t(!1)},_=Object(x.a)((e=>({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})))((e=>{const{children:l,classes:t,onClose:n,...a}=e;return Object(f.jsxs)(h.a,{disableTypography:!0,className:t.root,...a,children:[Object(f.jsx)(O.a,{variant:"h6",children:l}),n?Object(f.jsx)(i.a,{"aria-label":"close",className:t.closeButton,onClick:n,children:Object(f.jsx)(m.a,{})}):null]})}));return Object(f.jsxs)(j.a,{open:l,fullWidth:!0,maxWidth:"md",onClose:k,"aria-labelledby":"form-dialog-title",children:[Object(f.jsx)(_,{id:"customized-dialog-title",onClose:k,children:"Set Canteen PaymentPlan"}),Object(f.jsxs)("form",{action:"",children:[Object(f.jsx)(b.a,{children:Object(f.jsxs)("table",{className:"table",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{scope:"col"}),Object(f.jsx)("th",{scope:"col",children:"Plan 1"}),Object(f.jsx)("th",{scope:"col",children:"Plan 2"}),Object(f.jsx)("th",{scope:"col",children:"Plan 3"})]})}),Object(f.jsxs)("tbody",{children:[N&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{scope:"row",children:"Plan Name"}),Object(f.jsxs)("td",{children:[Object(f.jsx)("input",{ref:P({required:!0}),type:"text",name:"name1",value:null===d||void 0===d?void 0:d.plan1,onChange:e=>r({...d,plan1:e.target.value}),className:"form-control",placeholder:"Plan name"}),T.name1&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}),Object(f.jsxs)("td",{children:[Object(f.jsx)("input",{type:"text",className:"form-control",placeholder:"Plan  name",value:null===d||void 0===d?void 0:d.plan2,onChange:e=>r({...d,plan2:e.target.value}),ref:P({required:!0}),name:"name2"}),T.name2&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}),Object(f.jsxs)("td",{children:[Object(f.jsx)("input",{type:"text",className:"form-control",placeholder:"Plan  name",name:"name3",value:null===d||void 0===d?void 0:d.plan3,onChange:e=>r({...d,plan3:e.target.value}),ref:P({required:!0})}),T.name3&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]})]}),Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{scope:"row",children:"Plan Price"}),Object(f.jsxs)("td",{children:[Object(f.jsx)("input",{value:null===c||void 0===c?void 0:c.plan1,onChange:e=>s({...c,plan1:e.target.value}),type:"number",className:"form-control",placeholder:"Plan's price",name:"price1",ref:P({required:!0})}),T.price1&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}),Object(f.jsxs)("td",{children:[Object(f.jsx)("input",{value:null===c||void 0===c?void 0:c.plan2,onChange:e=>s({...c,plan2:e.target.value}),type:"number",className:"form-control",placeholder:"Plan's price",name:"price2",ref:P({required:!0})}),T.price2&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}),Object(f.jsxs)("td",{children:[Object(f.jsx)("input",{value:null===c||void 0===c?void 0:c.plan3,onChange:e=>s({...c,plan3:e.target.value}),type:"number",className:"form-control",placeholder:"Plan's price",name:"price3",ref:P({required:!0})}),T.price3&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]})]})]}),Object(f.jsxs)("tr",{children:[y?Object(f.jsxs)("th",{children:[Object(f.jsx)("input",{value:u,onChange:e=>g(e.target.value),type:"text",className:"form-control",placeholder:"Service's name",name:"title",ref:P({required:!0})}),T.title&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}):Object(f.jsx)("th",{scope:"row",children:(null===n||void 0===n?void 0:n.name)||"Description"}),Object(f.jsxs)("td",{children:[Object(f.jsx)("textarea",{value:null===n||void 0===n?void 0:n.plan1,onChange:e=>a({...n,plan1:e.target.value}),rows:3,className:"form-control",placeholder:"Type here...",name:"description1",ref:P({required:!0})}),T.description1&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}),Object(f.jsxs)("td",{children:[Object(f.jsx)("textarea",{value:null===n||void 0===n?void 0:n.plan2,onChange:e=>a({...n,plan2:e.target.value}),rows:3,className:"form-control",placeholder:"Type here...",name:"description2",ref:P({required:!0})}),T.description2&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]}),Object(f.jsxs)("td",{children:[Object(f.jsx)("textarea",{value:null===n||void 0===n?void 0:n.plan3,onChange:e=>a({...n,plan3:e.target.value}),rows:3,name:"description3",ref:P({required:!0}),className:"form-control",placeholder:"Type here..."}),T.description3&&Object(f.jsx)("div",{className:"text-danger mb-3",children:"This field is required."})]})]})]})]})}),Object(f.jsxs)(p.a,{children:[Object(f.jsxs)(o.a,{disabled:S,onClick:q(C),color:"primary",children:[S&&Object(f.jsx)("div",{className:"spinner-border spinner-border-sm",role:"status"}),y?"Add":"Save Changes"]}),Object(f.jsx)(o.a,{onClick:k,color:"secondary",children:"Cancel"})]})]})]})}var y=t(59),N=t(84),C=t(614),S=t(1247),P=t.n(S),q=t(963);l.default=function(){const e=Object(N.c)(y.d),[l,t]=Object(n.useState)({}),[a,s]=Object(n.useState)([]),[o,j]=Object(n.useState)([]),[p,b]=Object(n.useState)(!1),[h,v]=Object(n.useState)(!1),[u,m]=Object(n.useState)(!1),[O,x]=Object(n.useState)(""),[S,T]=Object(n.useState)(""),[k,_]=Object(n.useState)(!1),[w,A]=Object(n.useState)({plan1:"",plan2:"",plan3:""}),[M,W]=Object(n.useState)({plan1:"",plan2:"",plan3:""}),[z,B]=Object(n.useState)({plan1:"",plan2:"",plan3:""}),D=e=>{let l=[];return null===e||void 0===e||e.forEach((e=>{l.find((l=>l._id===e._id))||l.push(e)})),l};return Object(n.useEffect)((()=>{r.a.get("/paymentplan").then((e=>{var l,n;console.log(null===e||void 0===e?void 0:e.data),t(null===e||void 0===e?void 0:e.data),s(null===(l=e.data)||void 0===l?void 0:l.plans);let a=D(null===(n=e.data)||void 0===n?void 0:n.services);j(a)}))}),[]),Object(f.jsxs)("div",{children:["admin"===(null===e||void 0===e?void 0:e.role)&&Object(f.jsx)(q.a,{}),Object(f.jsx)("h3",{className:"my-5",children:"Canteen Payment Plan"}),Object(f.jsxs)("table",{className:"table content__container",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsxs)("th",{scope:"col",children:[Object(f.jsx)("h4",{children:"Avaliable Payment Plan"}),Object(f.jsxs)("p",{children:[" ",Object(f.jsx)("small",{children:" What kind of plan are you interested in "})]})]}),a&&(null===a||void 0===a?void 0:a.map((e=>Object(f.jsxs)("th",{scope:"col",children:[Object(f.jsx)("h5",{children:Object(f.jsx)("strong",{children:null===e||void 0===e?void 0:e.name})}),Object(f.jsx)("p",{children:Object(f.jsx)("small",{children:null===e||void 0===e?void 0:e.description})}),Object(f.jsxs)("h1",{className:"d-flex align-items-end",children:[Object(f.jsxs)("strong",{children:[Object(C.b)(),null===e||void 0===e?void 0:e.price]})," ",Object(f.jsx)("small",{style:{fontSize:"0.4em"},children:"/month"})," "]})]},e._id)))),"admin"===(null===e||void 0===e?void 0:e.role)&&Object(f.jsxs)("th",{children:[Object(f.jsx)("h5",{children:"Action"}),Object(f.jsx)(i.a,{onClick:()=>(()=>{let e=null===l||void 0===l?void 0:l.plans;var t,n,a,c,i,s,d,r,o;e&&(A({plan1:null===(t=e[0])||void 0===t?void 0:t.name,plan2:null===(n=e[1])||void 0===n?void 0:n.name,plan3:null===(a=e[2])||void 0===a?void 0:a.name}),B({plan1:null===(c=e[0])||void 0===c?void 0:c.description,plan2:null===(i=e[1])||void 0===i?void 0:i.description,plan3:null===(s=e[2])||void 0===s?void 0:s.description}),W({plan1:null===(d=e[0])||void 0===d?void 0:d.price,plan2:null===(r=e[1])||void 0===r?void 0:r.price,plan3:null===(o=e[2])||void 0===o?void 0:o.price})),b(!0)})(),children:Object(f.jsx)(c.a,{})})]})]})}),Object(f.jsxs)("tbody",{children:[o&&o.map((t=>Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{scope:"row",children:null===t||void 0===t?void 0:t.name}),Object(f.jsx)("td",{children:null===t||void 0===t?void 0:t.plan1}),Object(f.jsx)("td",{children:null===t||void 0===t?void 0:t.plan2}),Object(f.jsx)("td",{children:null===t||void 0===t?void 0:t.plan3}),"admin"===(null===e||void 0===e?void 0:e.role)&&Object(f.jsx)("td",{children:Object(f.jsxs)("div",{className:"d-flex",children:[Object(f.jsx)(i.a,{onClick:()=>(e=>{v(!0);let t=null===l||void 0===l?void 0:l.services.find((l=>l._id===e));B(t),console.log(t),T(e)})(null===t||void 0===t?void 0:t._id),children:Object(f.jsx)(c.a,{})}),Object(f.jsx)(i.a,{onClick:()=>{return e=null===t||void 0===t?void 0:t._id,void r.a.put("/paymentplan/delete/services/".concat(e)).then((l=>{if(l.data.error)return Object(C.c)(l.data.error),0;console.log(o.filter((l=>l._id!==e))),j(o.filter((l=>l._id!==e)))})).catch((e=>{console.log(e),Object(C.c)("Delete failed")}));var e},children:Object(f.jsx)(P.a,{})})]})})]},t._id))),"admin"===(null===e||void 0===e?void 0:e.role)&&Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{colSpan:"4",children:"Add Additional"}),Object(f.jsx)("th",{children:Object(f.jsx)(i.a,{onClick:()=>m(!0),children:Object(f.jsx)(d.a,{})})})]})]})]}),Object(f.jsx)(g,{open:p,name:w,loading:k,setname:A,descriptions:z,setdescriptions:B,prices:M,isPlans:!0,setprices:W,setOpen:b,onSubmit:()=>{_(!0),r.a.put("/paymentplan/update/plans",[{name:null===w||void 0===w?void 0:w.plan1,description:null===z||void 0===z?void 0:z.plan1,price:null===M||void 0===M?void 0:M.plan1,plan:"plan1"},{name:null===w||void 0===w?void 0:w.plan2,description:null===z||void 0===z?void 0:z.plan2,price:null===M||void 0===M?void 0:M.plan2,plan:"plan2"},{name:null===w||void 0===w?void 0:w.plan3,description:null===z||void 0===z?void 0:z.plan3,price:null===M||void 0===M?void 0:M.plan3,plan:"plan3"}]).then((e=>{var l;if(_(!1),e.data.error)return Object(C.c)(e.data.error),0;b(!1),W({}),B({}),A({}),Object(C.m)("Changes Saved"),console.log(e.data.doc),s(null===(l=e.data.doc)||void 0===l?void 0:l.plans)})).catch((e=>{_(!1),console.log(e),Object(C.c)("Changes failed to save")}))}}),Object(f.jsx)(g,{open:h,loading:k,descriptions:z,setdescriptions:B,setOpen:v,onSubmit:()=>{_(!0),r.a.put("/paymentplan/update/services/".concat(S),z).then((e=>{var l;if(_(!1),e.data.error)return Object(C.c)(e.data.error),0;v(!1),B({}),Object(C.m)("Changes Saved");let t=D(null===(l=e.data.doc)||void 0===l?void 0:l.services);j(t)})).catch((e=>{_(!1),console.log(e),Object(C.c)("Changes failed to save")}))}}),Object(f.jsx)(g,{title:O,loading:k,settitle:x,open:u,descriptions:z,setdescriptions:B,isAdd:!0,setOpen:m,onSubmit:()=>{_(!0),r.a.post("/paymentplan/add/service",{name:O,...z}).then((e=>{if(e.data.error)return Object(C.c)(e.data.error),0;_(!1),m(!1),B({}),x(""),Object(C.m)("Changes Saved"),console.log(e.data.doc),j([{name:O,...z},...o])})).catch((()=>{_(!1),Object(C.c)("Changes failed to save")}))}})]})}},963:function(e,l,t){"use strict";t(0);var n=t(123),a=t(10);l.a=function(){return Object(a.jsxs)("div",{className:"d-flex xs-flex-column sm-flex-row justify-content-end",children:[Object(a.jsx)(n.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/members/register",children:"Add  Canteen Member "}),Object(a.jsx)(n.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/members",children:"All Members"}),Object(a.jsx)(n.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/payments/plan",children:"Payments Plan"}),Object(a.jsx)(n.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/payments/add",children:"Make Payment"}),Object(a.jsx)(n.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/payments",children:"All Payments"})]})}}}]);
//# sourceMappingURL=9.ed8fa263.chunk.js.map
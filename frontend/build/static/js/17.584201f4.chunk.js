(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[17],{1474:function(e,t,c){"use strict";c.r(t);var s=c(0),n=c(638),a=c(10);var l=function(e){const{register:t,handleSubmit:c,errors:s}=Object(n.a)();let{studentID:l,setstudentID:d,planPrice:r,amount:i,setamount:o,handleAdd:j,loading:b}=e;return Object(a.jsxs)("form",{action:"",className:"row g-3",children:[Object(a.jsxs)("div",{className:"col-md-10",children:[Object(a.jsx)("label",{className:"form-label",children:"Canteen Member ID"}),Object(a.jsx)("input",{value:l,ref:t({required:!0}),onChange:e=>d(e.target.value),type:"text",className:"form-control",name:"userID"}),s.userID&&Object(a.jsx)("span",{className:" form-error text-danger mb-2",children:"This field is required"})]}),r&&Object(a.jsxs)("div",{className:"col-md-10",children:[Object(a.jsx)("label",{className:"form-label",children:"Amount Paid"}),[1,2,3].map((e=>Object(a.jsxs)("div",{className:"form-check",children:[Object(a.jsx)("input",{className:"form-check-input",value:r*e,type:"radio",onClick:e=>o(e.target.value),name:"flexRadioDefault"}),Object(a.jsx)("label",{className:"form-check-label",children:r*e})]}))),Object(a.jsx)("input",{value:i,ref:t({required:!0}),readOnly:!0,type:"number",className:"form-control",name:"amount"}),s.amount&&Object(a.jsx)("span",{className:" form-error text-danger mb-2",children:"This field is required"})]}),Object(a.jsx)("div",{className:"col-xs-12",children:Object(a.jsxs)("button",{disabled:b,onClick:c(j),className:"btn blue__btn",children:[b&&Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status"}),"Add"]})})]})},d=c(963),r=c(1498),i=c(614),o=c(617),j=c.n(o),b=c(27);var m=function(e){let{member:t,planName:c}=e;const[n,l]=Object(s.useState)({});Object(s.useEffect)((()=>{b.a.get("/user/".concat(null===t||void 0===t?void 0:t.userID)).then((e=>{l(e.data.user)}))}),[t]);const d=t.payments.reduce(((e,t)=>Number(e)+Number(t.amount)),0);return Object(a.jsxs)("div",{className:" content__container",children:[Object(a.jsxs)("div",{style:{background:"#051f3e"},className:"d-flex flex-column align-items-center p-3 text-light mb-4",children:[Object(a.jsx)(r.a,{src:Object(i.g)(null===n||void 0===n?void 0:n.profileUrl),style:{width:"100px",height:"100px"}}),Object(a.jsxs)("h3",{children:[Object(i.d)(null===n||void 0===n?void 0:n.name)," ",Object(i.h)(null===n||void 0===n?void 0:n.middlename)," ",Object(i.d)(null===n||void 0===n?void 0:n.surname)," - ",null===n||void 0===n?void 0:n.userID]}),Object(a.jsxs)("div",{children:[Object(a.jsxs)("strong",{children:[null===t||void 0===t?void 0:t.role," "]})," "]}),Object(a.jsxs)("div",{children:["Canteen Membership ID: ",null===t||void 0===t?void 0:t.memberID]}),Object(a.jsx)("hr",{}),Object(a.jsxs)("div",{children:[Object(a.jsxs)("strong",{children:["Payment Plan ",Object(a.jsx)("span",{className:"text-danger",children:c})," "]})," "]}),Object(a.jsxs)("div",{children:["Since ",j()(null===t||void 0===t?void 0:t.date).format("D MMMM  YYYY")," "]})]}),Object(a.jsxs)("table",{className:"table table-bordered",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"Date"}),Object(a.jsx)("th",{scope:"col",children:"Months Covered"}),Object(a.jsx)("th",{scope:"col",children:"Amount"})]})}),Object(a.jsxs)("tbody",{children:[(null===t||void 0===t?void 0:t.payments)&&(null===t||void 0===t?void 0:t.payments.map((e=>Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:j()(null===e||void 0===e?void 0:e.date).format("D MMMM  YYYY")}),Object(a.jsx)("td",{children:e.covers||"-"}),Object(a.jsxs)("td",{children:[Object(i.b)(),e.amount]})]},e._id)))),Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{colSpan:"2",children:"BALANCE"}),Object(a.jsxs)("td",{children:[Object(i.b)()," ",d]})]})]})]})]})};t.default=function(){const[e,t]=Object(s.useState)(""),[c,n]=Object(s.useState)([]),[r,o]=Object(s.useState)({}),[j,u]=Object(s.useState)(""),[h,O]=Object(s.useState)(!1),[x,v]=Object(s.useState)(""),[f,p]=Object(s.useState)(""),[N,y]=Object(s.useState)([]);Object(s.useEffect)((()=>{b.a.get("/canteen").then((e=>{n(e.data)}))}),[]),Object(s.useEffect)((()=>{b.a.get("/paymentplan").then((e=>{var t;y(null===(t=e.data)||void 0===t?void 0:t.plans)}))}),[]);const g=e=>{let s=c.find((t=>t.memberID===e));o(s);let n=N.find((e=>e.plan===(null===s||void 0===s?void 0:s.paymentMethod)));v(null===n||void 0===n?void 0:n.price),p(null===n||void 0===n?void 0:n.name),t(e)};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(d.a,{}),Object(a.jsx)("h3",{children:"Add Canteen Payment "}),Object(a.jsxs)("div",{className:"mb-5 row",children:[Object(a.jsxs)("div",{className:"col-sm-6  content__container",children:[Object(a.jsxs)("div",{className:"mb-5",children:[Object(a.jsx)("label",{className:"form-label",children:" Select Canteen Member"}),Object(a.jsxs)("select",{onChange:e=>g(e.target.value),className:"form-select",children:[Object(a.jsx)("option",{defaultValue:!0,hidden:!0,children:"Choose..."}),(null===c||void 0===c?void 0:c.length)>0?null===c||void 0===c?void 0:c.map((e=>Object(a.jsxs)("option",{value:e.memberID,children:[e.name," ",e.memberID]},e.memberID))):Object(a.jsx)("option",{disabled:!0,children:"No members yet"})]})]}),Object(a.jsx)(l,{studentID:e,setstudentID:g,handleAdd:()=>{O(!0),b.a.put("/canteen/payment/".concat(e),{amount:j,covers:j/x}).then((e=>{O(!1),e.data.error&&Object(i.c)(e.data.error),Object(i.m)("Payment succefully recorded"),u(""),o(e.data.doc)})).catch((e=>{Object(i.c)("Payment Failed"),console.log(e),O(!1)}))},loading:h,planPrice:x,amount:j,setamount:u})]}),Object(a.jsx)("div",{className:"col-sm-6",children:x&&Object(a.jsx)(m,{planName:f,member:r})})]})]})}},963:function(e,t,c){"use strict";c(0);var s=c(123),n=c(10);t.a=function(){return Object(n.jsxs)("div",{className:"d-flex xs-flex-column sm-flex-row justify-content-end",children:[Object(n.jsx)(s.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/members/register",children:"Add  Canteen Member "}),Object(n.jsx)(s.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/members",children:"All Members"}),Object(n.jsx)(s.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/payments/plan",children:"Payments Plan"}),Object(n.jsx)(s.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/payments/add",children:"Make Payment"}),Object(n.jsx)(s.c,{activeStyle:{color:"#ffa201"},className:"btn",to:"/canteen/payments",children:"All Payments"})]})}}}]);
//# sourceMappingURL=17.584201f4.chunk.js.map
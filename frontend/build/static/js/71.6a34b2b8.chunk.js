(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[71],{1459:function(e,t,a){"use strict";a.r(t);var s=a(0),c=a(621),n=a.n(c),l=a(1304),i=a(1022),o=a.n(i),r=a(27),d=a(97),j=a(814),b=a(711),h=a(783),O=a(791),u=a(797),m=a(633),x=a.n(m),v=a(1268),p=a(637),g=a(10);const y=Object(d.a)((e=>({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})))((e=>{const{children:t,classes:a,onClose:s,...c}=e;return Object(g.jsxs)(h.a,{disableTypography:!0,className:a.root,...c,children:[Object(g.jsx)(v.a,{variant:"h6",children:t}),s?Object(g.jsx)(l.a,{"aria-label":"close",className:a.closeButton,onClick:s,children:Object(g.jsx)(x.a,{})}):null]})})),f=Object(d.a)((e=>({root:{padding:e.spacing(2)}})))(O.a),w=Object(d.a)((e=>({root:{margin:0,padding:e.spacing(1)}})))(u.a);function S(e){let{open:t,setOpen:a,name:s,salary:c,allowance:n,bonus:l,setname:i,setsalary:o,isAdd:r,loading:d,onSubmit:h,setallowance:O,setbonus:u}=e;const{register:m,handleSubmit:x,errors:v}=Object(p.a)(),S=()=>{a(!1)};return Object(g.jsxs)(b.a,{onClose:S,fullWidth:!0,maxWidth:"sm","aria-labelledby":"customized-dialog-title",open:t,children:[Object(g.jsx)(y,{id:"customized-dialog-title",onClose:S,children:r?" Add New Staff Position":"Edit Staff Position"}),Object(g.jsxs)("form",{action:"",children:[Object(g.jsxs)(f,{children:[Object(g.jsxs)("div",{className:"mb-3",children:[Object(g.jsx)("label",{htmlFor:"",children:"Position's Name"}),r?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("input",{ref:m({required:!0}),type:"text",name:"name",value:s,onChange:e=>i(e.target.value),className:"form-control"}),v.name&&Object(g.jsx)("div",{className:"text-danger mb-3",children:"This field  is required."})]}):Object(g.jsx)("input",{ref:m({required:!0}),type:"text",name:"name",value:s,readOnly:!0,className:"form-control"})]}),Object(g.jsxs)("div",{className:"mb-3",children:[Object(g.jsx)("label",{htmlFor:"",children:"Salary"}),Object(g.jsx)("input",{ref:m({required:!0}),type:"number",name:"salary",value:c,onChange:e=>o(e.target.value),className:"form-control"}),v.salary&&Object(g.jsx)("div",{className:"text-danger mb-3",children:"This field  is required."})]}),Object(g.jsxs)("div",{className:"mb-3",children:[Object(g.jsx)("label",{htmlFor:"",children:"Allowance"}),Object(g.jsx)("input",{ref:m({required:!0}),type:"number",name:"allowance",value:n,onChange:e=>O(e.target.value),className:"form-control"}),v.allowance&&Object(g.jsx)("div",{className:"text-danger mb-3",children:"This field  is required."})]}),Object(g.jsxs)("div",{className:"mb-3",children:[Object(g.jsx)("label",{htmlFor:"",children:"Bonus"}),Object(g.jsx)("input",{ref:m({required:!0}),type:"number",name:"bonus",value:l,onChange:e=>u(e.target.value),className:"form-control"}),v.bonus&&Object(g.jsx)("div",{className:"text-danger mb-3",children:"This field  is required."})]})]}),Object(g.jsxs)(w,{children:[Object(g.jsxs)(j.a,{disabled:d,onClick:x(h),color:"primary",children:[d&&Object(g.jsx)("div",{className:"spinner-border spinner-border-sm",role:"status"}),r?"Add":"Save Changes"]}),Object(g.jsx)(j.a,{onClick:S,color:"secondary",children:"Cancel"})]})]})]})}var N=a(59),C=a(84),A=a(614),q=a(1238),k=a.n(q);t.default=function(){const e=Object(C.c)(N.d),[t,a]=Object(s.useState)([]),[c,i]=Object(s.useState)(!1),[d,j]=Object(s.useState)(!1),[b,h]=Object(s.useState)(""),[O,u]=Object(s.useState)(""),[m,x]=Object(s.useState)(!1),[v,p]=Object(s.useState)(""),[y,f]=Object(s.useState)(""),[w,q]=Object(s.useState)("");Object(s.useEffect)((()=>{r.a.get("/payrow").then((e=>{a(e.data)}))}),[]);let _=Object(A.b)();return Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{className:"my-5",children:"Staff Roles and Payrow Details"}),Object(g.jsxs)("table",{className:"table content__container",children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsxs)("th",{scope:"col",children:[Object(g.jsx)("h4",{children:"Staff Position"}),Object(g.jsxs)("p",{children:[" ",Object(g.jsx)("small",{children:" Available position in the school "})]})]}),Object(g.jsx)("th",{children:Object(g.jsx)("h5",{children:Object(g.jsxs)("strong",{children:[" Salary (",_,")"]})})}),Object(g.jsx)("th",{children:Object(g.jsx)("h5",{children:Object(g.jsxs)("strong",{children:[" Allowance (",_,")"]})})}),Object(g.jsx)("th",{children:Object(g.jsx)("h5",{children:Object(g.jsxs)("strong",{children:[" Bonus (",_,")"]})})}),"admin"===(null===e||void 0===e?void 0:e.role)&&Object(g.jsx)("th",{children:Object(g.jsx)("h5",{children:"Action"})})]})}),Object(g.jsxs)("tbody",{children:[t&&t.map((s=>Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{scope:"row",children:null===s||void 0===s?void 0:s.name}),Object(g.jsx)("td",{children:null===s||void 0===s?void 0:s.salary}),Object(g.jsx)("td",{children:null===s||void 0===s?void 0:s.allowance}),Object(g.jsx)("td",{children:null===s||void 0===s?void 0:s.bonus}),"admin"===(null===e||void 0===e?void 0:e.role)&&Object(g.jsxs)("td",{className:"d-flex",children:[Object(g.jsx)(l.a,{onClick:()=>(e=>{i(!0);let a=null===t||void 0===t?void 0:t.find((t=>t._id===e));q(null===a||void 0===a?void 0:a.salary),p(null===a||void 0===a?void 0:a.allowance),f(null===a||void 0===a?void 0:a.bonus),h(null===a||void 0===a?void 0:a.name),u(e)})(null===s||void 0===s?void 0:s._id),children:Object(g.jsx)(n.a,{})}),Object(g.jsx)(l.a,{onClick:()=>{return e=null===s||void 0===s?void 0:s._id,void r.a.delete("/payrow/delete/".concat(e)).then((s=>{if(s.data.error)return Object(A.c)(s.data.error),0;a(t.filter((t=>t._id!==e)))})).catch((e=>{console.log(e),Object(A.c)("Delete failed")}));var e},children:Object(g.jsx)(k.a,{})})]})]},s._id))),Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{colSpan:"4",children:"Add Additional Position"}),Object(g.jsx)("th",{children:Object(g.jsx)(l.a,{onClick:()=>j(!0),children:Object(g.jsx)(o.a,{})})})]})]})]}),Object(g.jsx)(S,{open:c,loading:m,salary:w,setsalary:q,bonus:y,name:b,setname:h,allowance:v,setallowance:p,setbonus:f,setOpen:i,onSubmit:()=>{x(!0),r.a.put("/payrow/update/".concat(O),{salary:w,allowance:v,bonus:y}).then((async e=>{if(x(!1),e.data.error)return Object(A.c)(e.data.error),0;i(!1),q(""),p(""),f(""),h(""),Object(A.m)("Changes Saved");let s=t;s[t.findIndex((e=>e._id===O))]=e.data.doc,a(s),await r.a.post("/activitylog/create",{activity:" ".concat(b," payrow was edited"),user:"admin"})})).catch((e=>{x(!1),console.log(e),Object(A.c)("Changes failed to save")}))}}),Object(g.jsx)(S,{name:b,loading:m,setname:h,allowance:v,setallowance:p,open:d,salary:w,bonus:y,setbonus:f,setsalary:q,isAdd:!0,setOpen:j,onSubmit:()=>{x(!0),r.a.post("/payrow/add",{name:b,salary:w,allowance:v,bonus:y}).then((async e=>{if(e.data.error)return Object(A.c)(e.data.error),0;x(!1),j(!1),q(""),p(""),f(""),h(""),Object(A.m)("Changes Saved"),a([e.data.doc,...t]),await r.a.post("/activitylog/create",{activity:" ".concat(b," payrow was created"),user:"admin"})})).catch((()=>{x(!1),Object(A.c)("Changes failed to save")}))}})]})}}}]);
//# sourceMappingURL=71.6a34b2b8.chunk.js.map
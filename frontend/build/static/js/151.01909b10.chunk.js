(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[151],{1039:function(e,t,s){"use strict";s(0);var c=s(10);t.a=function(){return Object(c.jsx)("div",{className:"default__chat",children:Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Welcome , Admin "}),Object(c.jsx)("h4",{children:"Messaging Chat system"})]})})}},1066:function(e,t,s){"use strict";var c=s(0),a=s(123),n=s(1463),i=s(27),l=s(614),d=s(26),o=s(84),r=s(10);var j=function(e){let{chat:t,currentUser:s}=e;const[j,u]=Object(c.useState)({}),[h,b]=Object(c.useState)({}),v=Object(o.c)(d.i),O=Object(o.b)();return Object(c.useEffect)((()=>{let e=s===(null===t||void 0===t?void 0:t.requestor_id)?null===t||void 0===t?void 0:t.acceptor_id:null===t||void 0===t?void 0:t.requestor_id;i.a.get("/user/".concat(e.trim())).then((e=>{let s=e.data.user;u({profileUrl:null===s||void 0===s?void 0:s.profileUrl,name:null===s||void 0===s?void 0:s.name,surname:null===s||void 0===s?void 0:s.surname}),b(null===t||void 0===t?void 0:t.messages.pop())}))}),[t,s]),Object(r.jsx)("div",{className:"sidemessage",children:Object(r.jsxs)(a.b,{onClick:()=>(async e=>{await i.a.put("/chats/update/chat/".concat(e,"/").concat(s)).then((e=>{console.log(e);let t=v.filter((e=>"chat"!==e.type));O(Object(d.v)(t))}))})(null===t||void 0===t?void 0:t._id),to:"/messages/chat/".concat(null===t||void 0===t?void 0:t._id),className:"d-flex",children:[Object(r.jsx)("div",{className:"mr-2",children:Object(r.jsx)(n.a,{alt:Object(l.h)((null===j||void 0===j?void 0:j.name)||"O"),src:Object(l.g)(null===j||void 0===j?void 0:j.profileUrl)})}),Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"d-flex align-center justify-content-between w-100",children:[Object(r.jsxs)("h6",{children:[Object(l.d)(null===j||void 0===j?void 0:j.name)," ",(null===j||void 0===j?void 0:j.surname)&&Object(l.i)(Object(l.d)(null===j||void 0===j?void 0:j.surname),5)]}),Object(r.jsx)("small",{className:"text-muted",children:Object(l.n)(null===h||void 0===h?void 0:h.date)})]}),Object(r.jsx)("span",{children:Object(l.i)((null===h||void 0===h?void 0:h.message)||"last message...",20)})]})]})})},u=s(59),h=s(1108),b=s.n(h),v=s(97),O=s(814),m=s(711),x=s(783),p=s(791),g=s(797),f=s(1304),_=s(633),N=s.n(_),S=s(1268),y=s(988),C=s.n(y),w=s(999),D=s.n(w),I=s(461);const U=Object(v.a)((e=>({root:{margin:0,padding:e.spacing(2)},icon:{width:"50px",height:"50px"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})))((e=>{const{children:t,classes:s,onClose:c,...a}=e;return Object(r.jsxs)(x.a,{disableTypography:!0,className:s.root,...a,children:[Object(r.jsx)(S.a,{variant:"h6",children:t}),c?Object(r.jsx)(f.a,{"aria-label":"close",className:s.closeButton,onClick:c,children:Object(r.jsx)(N.a,{})}):null]})})),k=Object(v.a)((e=>({root:{padding:e.spacing(2)}})))(p.a),q=Object(v.a)((e=>({root:{margin:0,padding:e.spacing(1)}})))(g.a);function R(e){let{open:t,setOpen:s,search:c,setsearch:a,handleSearch:n,loadingSearch:i,searchResults:l,loading:d,handleSendRequest:o,setsearchResults:j}=e;const u=()=>{a(""),j(""),s(!1)};return Object(r.jsx)("div",{children:Object(r.jsxs)(m.a,{fullWidth:!0,maxWidth:"sm",onClose:u,"aria-labelledby":"customized-dialog-title",open:t,children:[Object(r.jsx)(U,{id:"customized-dialog-title",onClose:u,children:"Find User"}),Object(r.jsxs)(k,{children:[Object(r.jsx)("form",{action:"",onSubmit:n,children:Object(r.jsxs)("div",{className:"search__user",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(C.a,{}),Object(r.jsx)("input",{value:c,onChange:e=>a(e.target.value),type:"text",placeholder:"Search by name or userID"})]}),c&&!i&&Object(r.jsx)(D.a,{onClick:()=>{a("")}}),Object(r.jsx)("div",{children:i&&Object(r.jsx)(I.a,{style:{width:"20px",height:"20px"}})})]})}),Object(r.jsxs)("div",{className:"mt-3 d-flex results__container justify-content-between align-items-start",children:[Object(r.jsx)("ul",{children:l&&l.map((e=>Object(r.jsx)("li",{children:Object(r.jsxs)("button",{onClick:()=>o(null===e||void 0===e?void 0:e.userID),className:"btn",children:[e.name," ",e.surname," - ",e.userID]})})))}),d&&Object(r.jsx)(I.a,{style:{width:"20px",height:"20px"}})]})]}),Object(r.jsx)(q,{children:Object(r.jsx)(O.a,{autoFocus:!0,onClick:u,color:"primary",children:"Close"})})]})})}t.a=function(){const[e,t]=Object(c.useState)([]),s=Object(o.c)(u.d),[a,n]=Object(c.useState)(!1),[d,h]=Object(c.useState)(""),[v,O]=Object(c.useState)(""),[m,x]=Object(c.useState)(!1),[p,g]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{i.a.get("/chats/chats/".concat(null===s||void 0===s?void 0:s.id)).then((e=>{t(e.data)}))}),[s]),Object(r.jsxs)("div",{className:"sidebar",children:[Object(r.jsx)("div",{className:"sidebar__header p-2 mb-2",children:Object(r.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(r.jsx)("h5",{children:Object(r.jsx)("strong",{children:"Chats"})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{onClick:()=>n(!0),className:"btn",children:Object(r.jsx)(b.a,{})})})]})}),Object(r.jsx)("div",{children:e&&e.sort(((e,t)=>e.updatedAt-t.updatedAt)).map((e=>Object(r.jsx)(j,{chat:e,currentUser:null===s||void 0===s?void 0:s.id},e._id)))}),Object(r.jsx)(R,{search:d,setsearch:h,handleSearch:e=>{console.log("search"),e.preventDefault(),d&&(x(!0),i.a.get("/users/search/".concat(d)).then((e=>{let t=e.data;x(!1),O(t)})).catch((e=>{console.log(e),g(!1)})))},open:a,searchResults:v,setsearchResults:O,loadingSearch:m,setOpen:n,loading:p,handleSendRequest:e=>{g(!0),i.a.post("/chats/create",{acceptor_id:e,requestor_id:null===s||void 0===s?void 0:s.userID}).then((e=>{if(g(!1),e.data.error)return Object(l.c)(e.data.error);n(!1),i.a.get("/chats/chats/".concat(null===s||void 0===s?void 0:s.userID)).then((e=>{t(e.data)}))})).catch((e=>{Object(l.c)("Faild"),g(!1)}))}})]})}},1067:function(e,t,s){"use strict";var c=s(0),a=s.n(c),n=s(614),i=s(10);var l=function(e){let{message:t,currentUser:s}=e;return Object(i.jsxs)("div",{className:s===(null===t||void 0===t?void 0:t.senderID)?"sender__mesaage message":"message",children:[Object(i.jsx)("div",{className:"message__content",children:null===t||void 0===t?void 0:t.message}),Object(i.jsx)("div",{className:"message__time ",children:Object(n.n)(t.date)})]})},d=s(16),o=s(27),r=s(84),j=s(59),u=s(1463);t.a=function(){const{id:e}=Object(d.i)(),[t,s]=Object(c.useState)([]),[h,b]=Object(c.useState)(""),[v,O]=Object(c.useState)({}),m=Object(r.c)(j.d),x=a.a.createRef();Object(c.useEffect)((()=>{p()}));const p=()=>{x.current.scrollIntoView({behavior:"smooth"})};return Object(c.useEffect)((()=>{o.a.get("/chats/chat/".concat(e)).then((async e=>{var t,c,a,n;s(null===(t=e.data)||void 0===t?void 0:t.messages);let i=(null===m||void 0===m?void 0:m.id)===(null===(c=e.data)||void 0===c?void 0:c.requestor_id)?null===(a=e.data)||void 0===a?void 0:a.acceptor_id:null===(n=e.data)||void 0===n?void 0:n.requestor_id;await o.a.get("/user/".concat(i)).then((e=>{O(e.data.user)}))}))}),[e,m]),Object(i.jsxs)("div",{className:"message__container",children:[Object(i.jsxs)("div",{className:"header d-flex",children:[Object(i.jsx)(u.a,{src:Object(n.g)(null===v||void 0===v?void 0:v.profileUrl),alt:Object(n.h)((null===v||void 0===v?void 0:v.name)||"U")}),Object(i.jsxs)("div",{className:"ml-3",children:[Object(i.jsxs)("h6",{children:[" ",Object(n.d)((null===v||void 0===v?void 0:v.name)||"A")," ",Object(n.d)(null===v||void 0===v?void 0:v.surname)]}),Object(i.jsx)("span",{children:null===v||void 0===v?void 0:v.userID})]})]}),Object(i.jsxs)("div",{className:"message__messages p-2",children:[t&&t.map((e=>Object(i.jsx)(l,{message:e,currentUser:null===m||void 0===m?void 0:m.id},e._id))),Object(i.jsx)("div",{ref:x})]}),Object(i.jsxs)("form",{onSubmit:t=>{t.preventDefault(),h&&o.a.put("/chats/send/".concat(e),{message:h,senderID:null===m||void 0===m?void 0:m.id,channelID:e}).then((e=>{var t;console.log(e.data),s(null===(t=e.data.doc)||void 0===t?void 0:t.messages),b("")}))},className:"send",children:[Object(i.jsx)("input",{value:h,onChange:e=>b(e.target.value),type:"text",placeholder:"Type here ..."}),Object(i.jsx)("button",{type:"submit",className:"btn",children:"Send"})]})]})}},1409:function(e,t,s){"use strict";s.r(t);s(0);var c=s(16),a=s(1066),n=s(1067),i=s(1039),l=s(10);t.default=function(){return Object(l.jsx)("div",{children:Object(l.jsxs)("div",{className:" messages__container ",children:[Object(l.jsx)(a.a,{}),Object(l.jsxs)(c.d,{children:[Object(l.jsx)(c.b,{component:n.a,path:"/messages/chat/:id"}),Object(l.jsx)(c.b,{component:i.a,path:"/messages/chat"})]})]})})}}}]);
//# sourceMappingURL=151.01909b10.chunk.js.map
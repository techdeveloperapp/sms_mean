(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[165],{1450:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s(798),c=s(27),r=s(614),o=s(84),l=s(59);function i(e,t,s,a){var n,c=!1,r=0;function o(){n&&clearTimeout(n)}function l(){for(var l=arguments.length,i=new Array(l),d=0;d<l;d++)i[d]=arguments[d];var j=this,b=Date.now()-r;function u(){r=Date.now(),s.apply(j,i)}c||(a&&!n&&u(),o(),void 0===a&&b>e?u():!0!==t&&(n=setTimeout(a?function(){n=void 0}:u,void 0===a?e-b:e)))}return"boolean"!==typeof t&&(a=s,s=t,t=void 0),l.cancel=function(){o(),c=!0},l}var d=s(10);t.default=function(){const[e,t]=Object(a.useState)(""),[s,j]=Object(a.useState)([]),[b,u]=Object(a.useState)(""),m=Object(o.c)(l.d),[h,O]=Object(a.useState)([]),[v,p]=Object(a.useState)(""),[x,f]=Object(a.useState)("Guadian"),N=()=>{v&&c.a.get("/students/search/".concat(v)).then((e=>{if(e.data.error)return Object(r.c)(e.data.error),0;O(e.data.users.map((e=>({_id:e._id,userID:e.userID,name:e.name,surname:e.surname}))))}))},g=(S=500,_=N,void 0===w?i(S,_,!1):i(S,w,!1!==_));var S,_,w;return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"mb-5 content__container row",children:Object(d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),N()},className:"mb-5 col-12 ",children:[Object(d.jsx)("label",{className:"form-label",children:"Search for Student by Name or ID"}),Object(d.jsxs)("div",{className:"d-flex flex-row",children:[Object(d.jsx)("input",{value:v,onChange:e=>{p(e.target.value),g(e.target.value)},className:"form-control",type:"text",placeholder:"Type here..."}),Object(d.jsx)("button",{className:"btn blue__btn",children:"Search"})]}),Object(d.jsx)("ul",{className:"students__container",children:h.length>0?Object(d.jsx)(d.Fragment,{children:h.map((e=>Object(d.jsxs)("li",{onClick:()=>{return t=e._id,void c.a.get("/students/parents/".concat(t)).then((e=>{if(console.log(e.data),e.data.error)return Object(r.c)(e.data.error),0;j(e.data.docs)}));var t},className:"option",children:[e.name," ",e.surname," ",e.userID," "]},e._id)))}):Object(d.jsx)("li",{children:"No results found"})})]})}),s.length>0&&Object(d.jsx)(n.a,{message:e,setmessage:t,onSend:a=>{if(a.preventDefault(),e&&b){let a=s.find((e=>e.id===b));if(null===a||void 0===a||!a.mobile)return Object(r.c)("Parent does not have phone number");c.a.post("/chats",{message:e,userID:b,telephone:null===a||void 0===a?void 0:a.mobile,sender:null===m||void 0===m?void 0:m.id}).then((e=>{if(e.data.error)return Object(r.c)(e.data.error),0;Object(r.m)("message send"),t("")}))}},searchOptions:()=>s.map((e=>Object(d.jsxs)("option",{value:e.id,children:[e.name," ",e.surname," ",e.relationship," "]},e.id))),recipient:b,setrecipient:u,sender:null===m||void 0===m?void 0:m.id,sendto:x})]})}},798:function(e,t,s){"use strict";s(0);var a=s(10);t.a=function(e){let{message:t,setmessage:s,onSend:n,recipient:c,setrecipient:r,sender:o,sendto:l,searchOptions:i,loading:d,error:j}=e;return Object(a.jsxs)("form",{action:"",className:" content__container form__sender",children:[Object(a.jsx)("div",{className:"header",children:Object(a.jsxs)("h3",{children:["Send Message to ",l]})}),Object(a.jsxs)("div",{className:"row mb-2 px-3",children:[Object(a.jsx)("label",{className:"col-sm-2",htmlFor:"",children:"Recipient:"}),Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsxs)("select",{value:c,onChange:e=>r(e.target.value),id:"inputState",className:"form-select",children:[Object(a.jsx)("option",{defaultChecked:!0,hidden:!0,children:"Choose..."}),i?i():Object(a.jsx)("option",{disabled:!0,children:"No options"})]})})]}),Object(a.jsxs)("div",{className:"row mb-2 px-3",children:[Object(a.jsx)("label",{className:"col-sm-2",htmlFor:"",children:"Sender:"}),Object(a.jsx)("div",{className:"col-sm-10",children:Object(a.jsx)("input",{className:"form-control",value:o,type:"text",readOnly:!0})})]}),Object(a.jsxs)("div",{className:"mb-2 row",children:[Object(a.jsx)("div",{className:"col-12",children:Object(a.jsx)("textarea",{value:t,onChange:e=>s(e.target.value),className:"form-control",name:"",rows:"10",required:!0,placeholder:"Type here"})}),j&&Object(a.jsx)("div",{className:"text-danger text-center mb-2",children:j}),Object(a.jsx)("div",{className:"col-12",children:Object(a.jsxs)("button",{disabled:d,onClick:n,className:"btn blue__btn w-100",children:[d&&Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Send"]})})]})]})}}}]);
//# sourceMappingURL=165.fd645089.chunk.js.map
(this["webpackJsonpschool-dashoboard"]=this["webpackJsonpschool-dashoboard"]||[]).push([[172],{1475:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),l=a(457),s=a(941),i=a(942),o=a(937),r=a(939),d=a(940),j=a(686),b=a(1446),u=a(938),m=a(927),h=a(629),O=a(617),x=a.n(O),p=a(123),v=a(614),f=a(10);const g=Object(l.a)({table:{width:"100%"}});function N(e){var t;let{data:a}=e;const n=g(),[l,O]=c.a.useState(0),[N,y]=c.a.useState(5);Math.min(N,(null===a||void 0===a?void 0:a.length)-l*N);return Object(f.jsx)(d.a,{component:m.a,children:Object(f.jsxs)(s.a,{className:n.table,"aria-label":"custom pagination table",children:[Object(f.jsx)(o.a,{children:Object(f.jsxs)(u.a,{children:[Object(f.jsx)(r.a,{children:"Date"}),Object(f.jsx)(r.a,{align:"left",children:"Receipt"}),Object(f.jsx)(r.a,{align:"left",children:"Student"}),Object(f.jsxs)(r.a,{align:"left",children:["Amount (",Object(v.b)(),")"]})]})}),Object(f.jsx)(i.a,{children:(null===a||void 0===a?void 0:a.length)<=0?Object(f.jsx)(u.a,{children:Object(f.jsx)(r.a,{colSpan:4,className:"text-center my-5",children:"No data"})}):Object(f.jsx)(f.Fragment,{children:null===(t=N>0?null===a||void 0===a?void 0:a.slice(l*N,l*N+N):a)||void 0===t?void 0:t.map((e=>{var t;return Object(f.jsxs)(u.a,{children:[Object(f.jsx)(r.a,{align:"left",children:null===(t=x()(null===e||void 0===e?void 0:e.date))||void 0===t?void 0:t.format("D MMMM YYYY")}),Object(f.jsxs)(r.a,{align:"left",children:[" ",Object(f.jsx)(p.b,{to:"/store/sales/receipt/".concat(null===e||void 0===e?void 0:e._id),children:null===e||void 0===e?void 0:e._id})]}),Object(f.jsx)(r.a,{align:"left",children:null===e||void 0===e?void 0:e.name}),Object(f.jsx)(r.a,{align:"left",children:null===e||void 0===e?void 0:e.totalCost})]},e._id)}))})}),Object(f.jsx)(j.a,{children:Object(f.jsx)(u.a,{children:(null===a||void 0===a?void 0:a.length)>5&&Object(f.jsx)(b.a,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],count:null===a||void 0===a?void 0:a.length,rowsPerPage:N,page:l,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},onChangePage:(e,t)=>{O(t)},onChangeRowsPerPage:e=>{y(parseInt(e.target.value,10)),O(0)},ActionsComponent:h.a})})})]})})}var y=a(711),S=a(1338),C=a(636),_=a.n(C),D=a(1285),w=a(27),P=a(1e3),I=a(961),k=a(1246);const A=Object(l.a)((e=>({appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}))),q=c.a.forwardRef((function(e,t){return Object(f.jsx)(P.a,{direction:"up",ref:t,...e})}));function M(e){let{student:t,setstudent:a,open:c,setOpen:l,totalprice:s,amount:i,setamount:o,buyitems:r,handleChangeDiscount:d,items:j,loading:b,handleSetitem:u,handleAddItem:m,handleChangeQty:h,handleAddSale:O}=e;const[x,p]=Object(n.useState)([]),v=A(),g=()=>{l(!1)};return Object(n.useEffect)((()=>{w.a.get("/students").then((e=>{p(e.data)}))}),[]),Object(f.jsxs)(y.a,{fullScreen:!0,open:c,onClose:g,TransitionComponent:q,className:"content__container","aria-labelledby":"customized-dialog-title",children:[Object(f.jsx)(I.a,{color:"transparent",className:v.appBar,children:Object(f.jsxs)(k.a,{children:[Object(f.jsx)(D.a,{variant:"h6",className:v.title,children:"Create New Sale"}),Object(f.jsx)(S.a,{edge:"start",color:"inherit",onClick:g,"aria-label":"close",children:Object(f.jsx)(_.a,{})})]})}),Object(f.jsxs)("form",{action:"",className:"mt-3 px-5",children:[Object(f.jsxs)("div",{className:"row",children:[Object(f.jsxs)("div",{className:"col-sm-6   mb-3",children:[Object(f.jsx)("label",{className:" form-label",children:"Student"}),Object(f.jsxs)("select",{value:t,onChange:e=>a(e.target.value),name:"student",className:"form-select","aria-label":"Default select example",children:[Object(f.jsx)("option",{defaultValue:!0,hidden:!0,children:"select"}),(null===x||void 0===x?void 0:x.length)>0?null===x||void 0===x?void 0:x.map((e=>Object(f.jsxs)("option",{value:e.userID,children:[e.name," ",null===e||void 0===e?void 0:e.surname]},e._id))):Object(f.jsx)("option",{disabled:!0,children:"No student yet"})]})]}),Object(f.jsxs)("div",{className:" col-sm-6   mb-3",children:[Object(f.jsx)("label",{className:" form-label",children:"Amount Paid"}),Object(f.jsx)("input",{name:"employmentdate",value:i,onChange:e=>o(e.target.value),type:"number",className:"form-control"})]})]}),Object(f.jsxs)("table",{className:"table table-borderless",children:[Object(f.jsx)("thead",{className:"table-dark",children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{colSpan:3,children:"Item Details"}),Object(f.jsx)("th",{scope:"col",children:"Quantity"}),Object(f.jsx)("th",{scope:"col",children:"Rate"}),Object(f.jsx)("th",{scope:"col",children:"Discount (%)"}),Object(f.jsx)("th",{scope:"col",children:"Amount"})]})}),Object(f.jsxs)("tbody",{children:[r&&r.map(((e,t)=>Object(f.jsxs)("tr",{children:[Object(f.jsxs)("th",{colSpan:3,children:[Object(f.jsx)("textarea",{className:"form-control",name:"item",rows:"2",value:e.name,readOnly:!0}),Object(f.jsxs)("select",{defaultValue:"item",onChange:e=>u(e.target.value,t),name:"item",className:"form-select","aria-label":"Default select example",children:[Object(f.jsx)("option",{defaultValue:!0,hidden:!0,children:"select"}),(null===j||void 0===j?void 0:j.length)>0?null===j||void 0===j?void 0:j.map((e=>Object(f.jsx)("option",{value:null===e||void 0===e?void 0:e._id,children:e.name},e._id))):Object(f.jsx)("option",{disabled:!0,children:"No item yet"})]})]}),Object(f.jsx)("th",{scope:"col",children:Object(f.jsx)("input",{name:"quantity",className:"form-control",onChange:e=>h(e.target.value,t),value:e.qty,type:"number"})}),Object(f.jsx)("th",{scope:"col",children:Object(f.jsx)("input",{name:"rate",readOnly:!0,value:e.rate,className:"form-control",type:"number"})}),Object(f.jsx)("th",{scope:"col",children:Object(f.jsx)("input",{name:"discount",className:"form-control",value:e.discount,onChange:e=>d(e.target.value,t),type:"number"})}),Object(f.jsx)("th",{scope:"col",children:Object(f.jsx)("input",{name:"amount",className:"form-control",readOnly:!0,value:e.amount,type:"number"})})]},t))),Object(f.jsx)("tr",{children:Object(f.jsx)("button",{onClick:m,className:"btn blue__btn",children:"+ Add another item"})}),Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{colSpan:5}),Object(f.jsx)("th",{colSpan:2,children:Object(f.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(f.jsx)("span",{children:"Items Total Price"}),Object(f.jsx)("span",{children:s})]})})]}),Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{colSpan:5}),Object(f.jsx)("th",{colSpan:2,children:Object(f.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(f.jsx)("span",{children:"Balance "}),Object(f.jsx)("span",{children:(i-s).toFixed(2)})]})})]})]})]}),Object(f.jsx)("div",{className:"d-flex justify-content-end",children:Object(f.jsx)("button",{className:"btn blue__btn",autoFocus:!0,disabled:0===s||0===i||b,onClick:O,color:"primary",children:"Complete Sale"})})]})]})}var F=a(16);t.default=function(){const[e,t]=Object(n.useState)([]),[a,c]=Object(n.useState)(!1),[l,s]=Object(n.useState)(""),[i,o]=Object(n.useState)(0),[r,d]=Object(n.useState)([]),[j,b]=Object(n.useState)(!1),u=Object(F.g)(),[m,h]=Object(n.useState)([{qty:0,rate:0,discount:0,amount:0,name:"",id:0,itemID:""}]);Object(n.useEffect)((()=>{w.a.get("/store/sales").then((e=>{t(e.data)}))}),[]),Object(n.useEffect)((()=>{w.a.get("/store/items").then((e=>{d(e.data)}))}),[]);const O=(e,t,a)=>{if(e||t||a){let n=Number(e)*Number(a);return(n-Number(t)*n).toFixed(2)}return 0},x=m.reduce(((e,t)=>e+Number(t.amount)),0);return console.log(m),Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{className:"mb-5 d-flex justify-content-between content__container ",children:[Object(f.jsx)("div",{children:Object(f.jsx)("button",{onClick:()=>c(!0),className:"btn blue__btn",children:"New Sale"})}),Object(f.jsx)("form",{action:"",children:Object(f.jsx)("input",{placeholder:"Search....",className:"form-control",type:"text"})})]}),Object(f.jsx)(N,{data:e}),Object(f.jsx)(M,{student:l,setstudent:s,amount:i,setamount:o,buyitems:m,handleChangeQty:(e,t)=>{console.log(e,t),h(m.map((a=>a.id===t?{qty:Number(e),amount:O(a.rate,a.discount,e),name:a.name,rate:a.rate,discount:a.discount,itemID:a.itemID,id:t}:a)))},handleAddItem:e=>{e.preventDefault(),h([...m,{qty:0,rate:0,discount:0,amount:0,name:"",id:m.length,itemID:""}])},items:r,open:a,loading:j,handleAddSale:e=>{if(e.preventDefault(),!l)return Object(v.c)("please select student");b(!0),w.a.post("/store/sales/create",{amountPaid:i,totalCost:x,name:l,items:m,seller:"admin"}).then((e=>{var t;if(b(!1),e.data.error)return Object(v.c)(e.data.error),0;Object(v.m)("payment successfully added"),u.push("/store/sales/receipt/".concat(null===(t=e.data.doc)||void 0===t?void 0:t._id))})).catch((e=>{b(!1),console.log(e)}))},totalprice:x,handleChangeDiscount:(e,t)=>{console.log(e),h(m.map((a=>(console.log(a),a.id===t?{discount:Number(e),name:a.name,rate:a.rate,qty:a.qty,amount:O(a.rate,e,a.qty),id:t,itemID:a.itemID}:a))))},handleSetitem:(e,t)=>{let a=r.find((t=>t._id===e));h(m.map((e=>e.id===t?{name:a.name,rate:a.price,itemID:a._id,amount:a.price,discount:0,id:t,qty:1}:e)))},setOpen:c})]})}},629:function(e,t,a){"use strict";a(0);var n=a(457),c=a(160),l=a(1338),s=a(626),i=a.n(s),o=a(628),r=a.n(o),d=a(627),j=a.n(d),b=a(625),u=a.n(b),m=a(10);const h=Object(n.a)((e=>({root:{flexShrink:0,marginLeft:e.spacing(2.5)}})));t.a=function(e){const t=h(),a=Object(c.a)(),{count:n,page:s,rowsPerPage:o,onChangePage:d}=e;return Object(m.jsxs)("div",{className:t.root,children:[Object(m.jsx)(l.a,{onClick:e=>{d(e,0)},disabled:0===s,"aria-label":"first page",children:"rtl"===a.direction?Object(m.jsx)(u.a,{}):Object(m.jsx)(i.a,{})}),Object(m.jsx)(l.a,{onClick:e=>{d(e,s-1)},disabled:0===s,"aria-label":"previous page",children:"rtl"===a.direction?Object(m.jsx)(j.a,{}):Object(m.jsx)(r.a,{})}),Object(m.jsx)(l.a,{onClick:e=>{d(e,s+1)},disabled:s>=Math.ceil(n/o)-1,"aria-label":"next page",children:"rtl"===a.direction?Object(m.jsx)(r.a,{}):Object(m.jsx)(j.a,{})}),Object(m.jsx)(l.a,{onClick:e=>{d(e,Math.max(0,Math.ceil(n/o)-1))},disabled:s>=Math.ceil(n/o)-1,"aria-label":"last page",children:"rtl"===a.direction?Object(m.jsx)(i.a,{}):Object(m.jsx)(u.a,{})})]})}}}]);
//# sourceMappingURL=172.422712ea.chunk.js.map